<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - TIMELY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .timetable-grid {
            grid-template-columns: 80px repeat(5, minmax(0, 1fr));
            border: 1px solid #4B5563;
            border-radius: 8px;
            overflow: hidden;
        }
        .timetable-slot {
            transition: all 0.2s ease-in-out;
            min-height: 80px;
        }
        .timetable-grid > div {
            border-bottom: 1px solid #4B5563;
        }
    </style>
</head>
<body class="bg-gray-900 text-white antialiased">

    <div class="container mx-auto p-4 md:p-8">
        <!-- Header -->
        <header class="flex items-center justify-between mb-8">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-cyan-400">Student Dashboard</h1>
                <p class="text-gray-400 mt-2">Welcome to your academic schedule</p>
            </div>
            <button onclick="window.location.href='../index.html'" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition duration-200">
                ‚Üê Logout
            </button>
        </header>

        <!-- Student Info Card -->
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg mb-8">
            <div class="flex items-center space-x-4">
                <div class="w-16 h-16 bg-cyan-600 rounded-full flex items-center justify-center">
                    <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
                    </svg>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-white">John Doe</h2>
                    <p class="text-gray-400">Computer Science Engineering</p>
                    <p class="text-sm text-cyan-300">Section: 2A | Roll No: CS2024001</p>
                </div>
            </div>
        </div>

        <!-- Attendance Graph -->
        <div class="bg-gray-800 p-6 rounded-xl shadow-lg mb-8">
            <h2 class="text-2xl font-bold text-cyan-300 mb-6">Subject-wise Attendance</h2>
            <div id="attendance-graph" class="space-y-4">
                <!-- Attendance bars will be generated here -->
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- My Timetable -->
            <div class="lg:col-span-2 bg-gray-800 p-6 rounded-xl shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-cyan-300">My Timetable</h2>
                    <div class="flex gap-2">
                        <button id="current-week" class="bg-cyan-600 hover:bg-cyan-700 text-white px-3 py-1 rounded text-sm transition duration-200">
                            Current Week
                        </button>
                        <button id="next-week" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition duration-200">
                            Next Week
                        </button>
                    </div>
                </div>
                
                <div id="timetable-container" class="overflow-x-auto">
                    <!-- Timetable will be generated here -->
                </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
                <!-- Today's Classes -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-cyan-300">Today's Classes</h3>
                    <div id="today-classes" class="space-y-3">
                        <!-- Today's classes will be populated here -->
                    </div>
                </div>

                <!-- Upcoming Assignments -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-cyan-300">Upcoming Assignments</h3>
                    <div id="assignments" class="space-y-3">
                        <!-- Assignments will be populated here -->
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-cyan-300">Quick Stats</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Total Classes</span>
                            <span class="text-white font-semibold">24/week</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Attendance</span>
                            <span class="text-green-400 font-semibold">95%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">CGPA</span>
                            <span class="text-yellow-400 font-semibold">8.5</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
        const TIME_SLOTS = ['1:30-2:10', '2:10-2:50', '2:50-3:30', '3:30-4:10', '4:10-4:50', '4:50-5:30', '5:30-6:00'];

        // Sample student timetable data
        const studentSchedule = {
            'Monday-1:30-2:10': [{ subject: 'Data Structures', faculty: 'Dr. Smith', room: 'CS Lab 1' }],
            'Monday-2:10-2:50': [{ subject: 'Data Structures', faculty: 'Dr. Smith', room: 'CS Lab 1' }],
            'Monday-3:30-4:10': [{ subject: 'Mathematics', faculty: 'Prof. Johnson', room: 'Room 201' }],
            'Tuesday-1:30-2:10': [{ subject: 'Computer Networks', faculty: 'Dr. Brown', room: 'CS Lab 2' }],
            'Tuesday-2:10-2:50': [{ subject: 'Computer Networks', faculty: 'Dr. Brown', room: 'CS Lab 2' }],
            'Tuesday-4:10-4:50': [{ subject: 'Operating Systems', faculty: 'Dr. Wilson', room: 'Room 203' }],
            'Wednesday-2:50-3:30': [{ subject: 'Database Systems', faculty: 'Dr. Davis', room: 'CS Lab 1' }],
            'Wednesday-3:30-4:10': [{ subject: 'Database Systems', faculty: 'Dr. Davis', room: 'CS Lab 1' }],
            'Thursday-1:30-2:10': [{ subject: 'Software Engineering', faculty: 'Dr. Miller', room: 'Room 205' }],
            'Thursday-2:10-2:50': [{ subject: 'Software Engineering', faculty: 'Dr. Miller', room: 'Room 205' }],
            'Friday-3:30-4:10': [{ subject: 'Web Development', faculty: 'Dr. Garcia', room: 'CS Lab 2' }],
            'Friday-4:10-4:50': [{ subject: 'Web Development', faculty: 'Dr. Garcia', room: 'CS Lab 2' }]
        };

        // Sample today's classes (assuming it's Monday)
        const todayClasses = [
            { time: '1:30-2:10', subject: 'Data Structures', faculty: 'Dr. Smith', room: 'CS Lab 1' },
            { time: '2:10-2:50', subject: 'Data Structures', faculty: 'Dr. Smith', room: 'CS Lab 1' },
            { time: '3:30-4:10', subject: 'Mathematics', faculty: 'Prof. Johnson', room: 'Room 201' }
        ];

        // Sample assignments
        const assignments = [
            { subject: 'Data Structures', title: 'Binary Tree Implementation', due: '2024-01-15', priority: 'high' },
            { subject: 'Computer Networks', title: 'Network Protocol Analysis', due: '2024-01-18', priority: 'medium' },
            { subject: 'Database Systems', title: 'SQL Query Optimization', due: '2024-01-20', priority: 'low' }
        ];

        // Sample attendance data
        const attendanceData = [
            { subject: 'Data Structures', attended: 18, total: 24, percentage: 75 },
            { subject: 'Computer Networks', attended: 12, total: 20, percentage: 60 },
            { subject: 'Mathematics', attended: 15, total: 18, percentage: 83.33 },
            { subject: 'Operating Systems', attended: 8, total: 16, percentage: 50 },
            { subject: 'Database Systems', attended: 14, total: 16, percentage: 87.5 },
            { subject: 'Software Engineering', attended: 10, total: 12, percentage: 83.33 },
            { subject: 'Web Development', attended: 6, total: 8, percentage: 75 }
        ];

        // Algorithm to calculate lectures needed to reach 75% attendance
        function calculateLecturesNeeded(attended, total) {
            const targetPercentage = 75;
            const currentPercentage = (attended / total) * 100;
            
            if (currentPercentage >= targetPercentage) {
                return 0; // Already above 75%
            }
            
            // Let x be the number of additional lectures needed
            // We need: (attended + x) / (total + x) >= 0.75
            // Solving: attended + x >= 0.75 * (total + x)
            // attended + x >= 0.75 * total + 0.75 * x
            // x - 0.75 * x >= 0.75 * total - attended
            // 0.25 * x >= 0.75 * total - attended
            // x >= (0.75 * total - attended) / 0.25
            // x >= 3 * total - 4 * attended
            
            const lecturesNeeded = Math.ceil(3 * total - 4 * attended);
            return Math.max(0, lecturesNeeded); // Ensure non-negative
        }

        function renderAttendanceGraph() {
            const attendanceGraphContainer = document.getElementById('attendance-graph');
            attendanceGraphContainer.innerHTML = attendanceData.map(data => {
                const lecturesNeeded = calculateLecturesNeeded(data.attended, data.total);
                const isAbove75 = data.percentage >= 75;
                const barColor = isAbove75 ? 'bg-green-500' : 'bg-red-500';
                const textColor = isAbove75 ? 'text-green-400' : 'text-red-400';
                
                return `
                    <div class="bg-gray-700 p-4 rounded-lg">
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex items-center space-x-3">
                                <h3 class="font-semibold text-white">${data.subject}</h3>
                                <span class="text-sm text-gray-400">${data.attended}/${data.total} lectures</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-lg font-bold ${textColor}">${data.percentage.toFixed(1)}%</span>
                                ${!isAbove75 ? `<span class="text-xs text-yellow-400">Need ${lecturesNeeded} more</span>` : ''}
                            </div>
                        </div>
                        <div class="w-full bg-gray-600 rounded-full h-3">
                            <div class="${barColor} h-3 rounded-full transition-all duration-500" style="width: ${Math.min(data.percentage, 100)}%"></div>
                        </div>
                        ${!isAbove75 ? `
                            <div class="mt-2 text-xs text-yellow-300">
                                <span class="font-medium">To reach 75%:</span> Attend ${lecturesNeeded} more lecture${lecturesNeeded !== 1 ? 's' : ''} 
                                (will be ${data.attended + lecturesNeeded}/${data.total + lecturesNeeded} = ${(((data.attended + lecturesNeeded) / (data.total + lecturesNeeded)) * 100).toFixed(1)}%)
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function renderTimetable() {
            const timetableContainer = document.getElementById('timetable-container');
            timetableContainer.innerHTML = '';
            
            const grid = document.createElement('div');
            grid.className = 'grid timetable-grid gap-1';

            // Add headers
            grid.innerHTML += '<div></div>'; // Empty corner
            DAYS.forEach(day => {
                grid.innerHTML += `<div class="font-bold text-center text-cyan-400 p-2 text-sm md:text-base">${day}</div>`;
            });

            // Add time slots and cells
            TIME_SLOTS.forEach(time => {
                grid.innerHTML += `<div class="font-bold text-center text-cyan-400 p-2 text-xs md:text-sm border-r border-gray-600">${time}</div>`;
                DAYS.forEach(day => {
                    const slotId = `${day}-${time}`;
                    const entries = studentSchedule[slotId] || [];
                    let content = '';
                    
                    if (entries.length > 0) {
                        content = entries.map(entry => `
                            <div class="bg-cyan-700 p-2 rounded-md mb-1 text-center text-xs shadow-md timetable-slot hover:bg-cyan-600 border border-cyan-600">
                                <div class="font-bold text-white truncate">${entry.subject}</div>
                                <div class="text-cyan-200 truncate">${entry.faculty}</div>
                                <div class="text-cyan-400 text-xs truncate">(${entry.room})</div>
                            </div>
                        `).join('');
                    } else {
                        content = `<div class="bg-gray-700/50 rounded-md h-24 timetable-slot border border-gray-600"></div>`;
                    }
                    
                    grid.innerHTML += `<div id="${slotId}" class="border-r border-gray-600">${content}</div>`;
                });
            });

            timetableContainer.appendChild(grid);
        }

        function renderTodayClasses() {
            const todayClassesContainer = document.getElementById('today-classes');
            todayClassesContainer.innerHTML = todayClasses.map(cls => `
                <div class="bg-gray-700 p-3 rounded-lg">
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="font-semibold text-white">${cls.subject}</div>
                            <div class="text-sm text-gray-400">${cls.faculty}</div>
                            <div class="text-xs text-cyan-300">${cls.room}</div>
                        </div>
                        <div class="text-xs text-cyan-400 font-medium">${cls.time}</div>
                    </div>
                </div>
            `).join('');
        }

        function renderAssignments() {
            const assignmentsContainer = document.getElementById('assignments');
            assignmentsContainer.innerHTML = assignments.map(assignment => {
                const priorityColor = assignment.priority === 'high' ? 'text-red-400' : 
                                    assignment.priority === 'medium' ? 'text-yellow-400' : 'text-green-400';
                return `
                    <div class="bg-gray-700 p-3 rounded-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold text-white">${assignment.title}</div>
                                <div class="text-sm text-gray-400">${assignment.subject}</div>
                            </div>
                            <div class="text-xs ${priorityColor} font-medium">${assignment.due}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Initialize the dashboard
        function initializeDashboard() {
            renderAttendanceGraph();
            renderTimetable();
            renderTodayClasses();
            renderAssignments();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
</body>
</html>
